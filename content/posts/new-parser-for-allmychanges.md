Title: Новый парсер для allmychanges.com
Slug: new-parser-for-allmychanges
Date: 2014-08-14 13:00
Category: texts
Tags: allmychanges, changelogs
Lang: ru

Как вы возможно знаете, проект [allmychanges.com][] появился на свет, как результат нашего участия в Django Dash 2013. С тех пор минул год, и всё это время проект использовал ту версию парсера ченьджлогов, которая была создана в
 Рамках хакатона. Лишь минимальные изменения были сделаны, чтобы улучшить парсинг. Отчасти это объясняется тем, что парсер код созданный второпях, было сложно модифицировать. Поэтому, некоторое время назад, я предпринял попытку переписать парсер с нуля. Так появилась вторая версия.

В настоящий момент оба парсера работают параллельно. Большинству пользователей сервиса видны результаты работы старого парсера, а за новым я слежу по мониторингам и визуально. Основной метрикой является общее количество версий ченьджлога, полученных тем или иным вариантом парсера.

До недавних пор новая версия значительно проигрывала в полноте старой. Она выдавала меньше тысячи версий, тогда как старая более 6 тысяч. Небольшое исследование показало, что происходит это из за того, что новый парсер по умолчанию трактует текст, как Markdown, и ищет номера версий только в заголовках. Однако многие разработчики не используют ни reST, ни Markdown в своих ченьджлогах. Особенно часто это встречается в перловых модулях типа [Mojolicious][].

Кстати, на днях вспомнил про библиотечку [Vandamme][], которую разработчики [Gemnasium][] предлагают использовать для парсинга ченьджлогов, и еще раз перечитал их readme. Оказалось, что решение которое они придумали — вовсе не подходит для разбора произвольных записей. Все что они предлагают — использовать один, придуманный ими формат для ченьджлогов. Эти ребята явно не учитывают многообразия окружающего их мира. Как быть, например, тем, у кого описание релиза это большой документ? А это так у многих популярных проектов вроде [Django][].

Чтобы исправить ситуацию в новом парсере [allmychanges.com][], я написал модуль, обрабатывающий plain text файлы.  Благо новая архитектура позволяет делать это легко и просто. И после релиза настал переломный момент:

Зеленая линия на этом графике — количество версий ченьджлога, выдаваемое новым парсером. Получается, что теперь полнота его даже выше чем у старой версии. Осталось немного последить за работой, сгладить шероховатости, и можно полностью переключаться на него.

Если кто-то хочет поучаствовать в тестировании, пишите мне, я включу вас в группу экспериментаторов.

[Vandamme]: https://github.com/tech-angels/vandamme#changelogs-convention
[Mojolicious]: https://github.com/kraih/mojo/blob/master/Changes
[Gemnasium]: https://gemnasium.com/
[Django]: https://github.com/django/django/tree/master/docs/releases
[allmychanges.com]: http://allmychanges.com
