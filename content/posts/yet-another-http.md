Title: Еще одна HTTP либа
Slug: yet-another-http
Date: 2011-02-16 11:11
Category: reviews
Tags: python
Lang: ru

Порой в твиттере прилетают интересные ссылки. Так, например, вчера Юрий Юревич заретвитил несколько обновлений с PyPi. Одно из них — новая [библиотечка для работы с HTTP][requests]. По сути, это всего лишь обертка над стандартными urllib и urllib2, призванная сделать работу с ними проще и понятней. Однако, уже по дизайну этого велосипеда видно, что где его можно улучшить.

Например, для того, чтобы использовать аутентификацию с именем пользователя и паролем, там предлагается сначала создать некий Auth объект и потом использовать его во всех вызовах:

    :::python
    conv_auth = requests.AuthObject('requeststest', 'requeststest')
    r = requests.get('https://convore.com/api/account/verify.json', auth=conv_auth)

Зачем? Если этот объект только и делает, что хранит имя пользователя и пароль, почему не использовать вместо него tuple (username, password)??? Если уж делаешь просто, почем не идешь до конца?

И еще пара замечаний по коду. Использовать с python2.5 его нельзя, потому что автор забыл про `from __future__ import absolute_import`, try except блоки тоже newstyle, в главном методе, посылающем запрос, чудовищный ifelse блок на два экрана. И еще, он пытается сам вызывать манкипатчинг, если присутствуют библиотеки eventlet или gevent. Что будет, если у меня они установлены в системе, но я не собираюсь их использовать?

[requests]: http://pypi.python.org/pypi/requests/
